<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Clientes</title>
    <link rel="stylesheet" href="style/cadastro.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="assets/icon (2).png">
</head>
<body>
    <div class="container">
        <h1>Cadastro de Clientes</h1>
      
<form id="form-cadastro">
    <input type="text" name="nome" placeholder="Nome" required>
    <input type="text" name="cpf" placeholder="CPF">
    <input type="text" name="telefone" placeholder="Telefone">
    <input type="text" name="cep" placeholder="CEP">
    <input type="text" name="endereco" placeholder="Endereço">
    <input type="text" name="numero" placeholder="Número">
    <input type="text" name="bairro" placeholder="Bairro">
    <input type="text" name="cidade" placeholder="Cidade">
    <input type="text" name="estado" placeholder="Estado">
    <input type="email" name="email" placeholder="Email" required>
    <input type="password" name="senha" placeholder="Senha" required>
    <button type="submit">Cadastrar</button>
</form>

<script>
const form = document.getElementById("form-cadastro");

form.addEventListener("submit", async (e) => {
    e.preventDefault(); // evita recarregar a página

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());

    try {
        const res = await fetch("http://localhost:3000/cadastro", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await res.json();

        if (res.ok) {
            alert(result.mensagem); // sucessohttp://localhost:3000/cadastro

            form.reset();
        } else {
            alert("Erro: " + result.erro);
        }
    } catch (err) {
        console.error("Erro ao enviar cadastro:", err);
        alert("Erro ao enviar cadastro.");
    }
});
</script>



           <p class="register-link">já possui uma conta? <a href="perfil.html">fazer login</a></p>
    </div>
    </div>

    <script>
    function buscarCEP() {
        const cep = document.querySelector('input[name="cep"]').value.replace(/\D/g, '');
        if (cep.length !== 8) return;

        fetch(`https://viacep.com.br/ws/${cep}/json/`)
        .then(response =>  response.json())
        .then(data => {
            if (!data.erro) {
                document.querySelector('input[name="endereco"]').value = data.logradouro || '';
                document.querySelector('input[name="bairro"]').value = data.bairro || '';
                document.querySelector('input[name="cidade"]').value = data.localidade || '';
                document.querySelector('input[name="estado"]').value = data.uf || '';
            } else {
                alert('CEP não encontrado!');
            }
        })
        .catch(err => {
            console.error('Erro ao buscar CEP:', err);
        });
    }

    document.querySelector('input[name="cep"]').addEventListener('blur', buscarCEP);
    </script>
</body>
</html>
